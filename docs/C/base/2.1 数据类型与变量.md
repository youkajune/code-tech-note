---
lang: zh-CN
title: 数据类型与变量
description: 
categories:
 - C语言
tags:
 - C语言
---

## 数据

### 什么是数据？

定义：**数据是所有能输入计算机并被计算机程序处理的符号介质的总称**。

### 为什么存储数据？

程序是由指令和数据组成的。在程序的指导下，计算机可以做许多事情，如数值计算、名字排序、执行语言或视频命令、计算彗星轨道、准备邮件列表、拨电话号码、画画、做决策或其他你能想到的事情。

要完成这些任务，就需要存储需要处理的信息。

### 如何存储数据？

为了把信息存储在计算机中，必须记录 3 个基本属性：

- 信息存储在哪里？
- 存储什么类型的信息？
- 存储什么值？

在 C 语言中，我们可以通过声明一个变量来实现存储信息，例如：

```c
int bra;
bra = 5;
```

这些语句告诉程序，正在存储整数，存储的整数值为 5，使用名称 bra 来表示该整数值(这里为 5)。实际上，程序在内存中找到一块能够存储整数的内存，将该内存单元标记为 bra，并将 5 复制到这个内存单元中；然后，可以在代码中使用 bra 来访问该内存单元。虽然这些语句并没有明确表明这个值应该存储在内存的什么位置，但程序确实记录了这种信息。事实上，可以通过 & 运算符来检索 bra 的地址。

## 标识符

### 什么是标识符？

标识符就是变量、函数、类型等的名字。它们由大小写字母、数字和下划线组成，但不能以数字开头。C 是一种区分大小写的语言。标识符的长度没有限制，但标准允许编译器忽略第 31 个字符以后的字符。
> 这里我们先介绍变量以及类型，函数以后再介绍。

### 标识符的命名

对于标识符，需要记住的知识点就是标识符的命名规则。我们首先来了解为什么要命名标识符？

对于计算机来说，没有命名不命名的，只有0和1。数据保存在内存中，程序使用数据时，需要知道该数据在内存中的地址，才能使用，而地址是由一系列的0、1组成。之所以要有命名是因为直接使用内存地址的话，不光使用的时候非常麻烦，而且阅读代码的时候也十分难以阅读。

C 语言的命名提供了一个机制，我们为使用的内存地址命了一个名，之后使用这个名字，程序会根据这个名字找到对应的内存地址，使用该数据。另外为了便于日后代码的阅读性，要求**命名时要使用有意义的变量名或标识符**。如果变量名无法清楚地表达自身的用途，可以在注释中进一步说明。

**结论：命名是为了我们编写和阅读代码方便而引入的，为了便于代码阅读，推荐命名时使用有意义的变量名或者标识符。**

C语言的标识符(包括变量和函数)命名遵循一下规则：

1. 可以用英文字母、数字、下划线(_) 来命名。
2. 英文字母区分大小写。例如，num、Num、NuM、NUM 是不同的。
3. 首字母不能是数字。
4. 不能使用 C 语言的关键字和保留标识符。

> Java 的命名规则中还可以用美元符号($)来命名，但是 C/C++ 不可以。
> PS：这里是因为我之前学过 Java，这里也是复习了一下 Java 的语法，初学者不用记忆。

## 变量

### 什么是变量？
```c
int bra;
bra = 5;
```

在上面的程序中声明了一个 bra 的变量，那么什么是变量呢？
变量这个名词其实来源于数学，**在计算机语言中变量是储存计算结果或能表示值的抽象概念**，变量可以通过变量名访问存储的值。也就是说，在 C 语言中，可以用变量来存储数据。

变量其实就是一种使用方便的占位符，用于引用计算机内存地址。使用变量时并不需要了解变量在计算机内存中的地址，只要通过变量名引用变量就可以查看或更改变量的值。

变量其实有很多需要学习的知识，包括命名规则、变量类型、类型转换、存储类型等，这里我们先学习较为简单的变量命名，其他部分之后再进行学习。

### 变量的使用(声明及初始化)

变量需要先进行声明，之后才能使用变量。下面，我们声明一个 int 类型的变量，并让其存储值 5。

```c
int arb; // 声明变量
arb = 5; // 存储值 5
```

上面的两条语句可以合并为一条初始化语句：

```c
int arb = 5; // 在声明变量的同时赋值的语句称为初始化语句
```

### 常量与变量

有些数据类型在程序使用之前已经预先设定好了，在整个程序的运行过程中没有变化，这些称为常量(constant)。其他数据类型在程序运行期间可能会改变或被赋值，这些称为变量(variable)。

C语言中一般使用 #define 来定义常量，不过后来也引入了 C++ 中的 const 关键字来定义常量。

## 类型

![](E:\Note\Code Language\the-c\picture\basic\2-1.png)

C 语言的数据类型包括基本数据类型、构造类型、指针类型、空类型这四大类，这里我们先只介绍第一类数据类型 —— 基本数据类型。基本数据类型是 C 语言内置的数据类型。

在 C 语言的基本数据类型中有整型、浮点型、字符类型。在学习基本数据类型时，我们需要关注这些类型的关键字，占多少字节内存，取值范围。

### 整型

**什么是整型？**所谓整型，即没有小数的数。它又包括正整数、0、负整数，同样我们的整型数据有正有负，也有0。C 语言提供了多种整数类型，程序员针对不同情况可以选择不同类型，一般情况使用 int 类型即可，但是为满足特定任务和机器要求，可以选择其他类型。

#### 整型 int

内存大小：C 语言规定，int 类型最少占 2 字节，最多不超过 long。对于 16 位编译器来说，int 是 2 字节，对于 32 位和 64 位编译器来说，int 是 4 字节。因为目前常用的是 32 位和 64 位编译器，因此一般来说 int 的范围是 [-2^31, 2^31-1]，即 [-2147483648, 2147483647]。

#### 短整型 short

内存大小：C 语言规定，short 类型最少占 2 字节，最多不超过 int。对于 16 位、32 位、64 位编译器来说，short 类型都是占 2 字节，取值范围是 [-2^15, 2^15 -1]，即 [-32768, 32767]。

#### 长整型 long

内存大小：C 语言规定，long 类型最少占 4 字节。对于 16 位、32 位编译器来说，long 占 4 字节，对于 64 位编译器来说，long 占 64 位。

由于 long 类型在常用的 32 位和 64 位编译器中存储的字节数不同，因此引入 long long 类型，long long 至少占 8 字节。

不同位数的编译器，整型数据所占字节数如下所示。

| **数据类型\编译器位数** | **16** | **32** | **64** |
| ----------------------- | ------ | ------ | ------ |
| **short**               | 2      | 2      | 2      |
| **int**                 | 2      | 4      | 4      |
| **long**                | 4      | 4      | 8      |
| **long long**           | 8      | 8      | 8      |

#### 为什么要使用多种整型?

首先，我们来看看**整型和我们平常所说的整数有什么差别？**

平常所说的整数是无限的，而整型是存储在计算机中的整数，它是有限的，是受限于计算机的存储单元的。之所以使用多种整型，正是因为这些整型由于存储时占据的字节数不同，使得它们的取值范围不同。这样我们就可以根据需要存储的数据的范围来选择使用的整型。

### 浮点型

**什么是浮点型？**所谓浮点型，即有小数的数。是因为小数点的位置可以自由浮动，因此称为浮点数。例如，1.234 和 12.34，虽然他们在大小上一致，但是在存储时有所不同。浮点型有单精度浮点数和双精度浮点数两种，所谓精度指的是能精确表示的有效数字，注意不是小数点后有效数字！！！。

#### 单精度浮点数 float

内存大小：占 4 字节。至少能精确表示6位有效数字。最高位为符号位，紧接着8位为指数位，剩下的23位为尾数位。

#### 双精度浮点数 double

内存大小：占 8 字节。至少能精确10位有效数字。最高位为符号位，紧接着8位为指数位，剩下的52位为尾数位。

### 字符型 char

内存大小：占 1 字节。其本质上是 1 字节的整型。大部分编译器默认 char 类型是有符号的，不过我们常用的是 [0，127] 这一部分，实际上其取值范围是 [-128，127]。

### 构造类型

有的数据比较复杂，我们可能会用到结构、数组等数据形式来表示。

### 指针类型

C 语言的重点内容就是指针和内存管理，所以这一部分呢很重要，在后面的学习中有一章专门讲解。

### 关键字

关键字是 C 语言中事先被定义了某些用途的词汇。有的用于指定不同的数据类型，例如，int。有的用于控制程序中语句的执行顺序，例如，if。这些我们都会在后面的学习中遇到。

| **分类**         | **关键字**                                                   |
| ---------------- | ------------------------------------------------------------ |
| **数据类型**     | char、short、int、long、float、double、unsigned、**const**、**void** |
| **流程控制**     | if、else、for、while、do...while、switch、case、default、continue、break、return、goto |
| **存储类别**     | static、auto、register、**volatile**                         |
| **其他数据形式** | struct、union、**enum**                                      |
| **其他**         | inline、extern、restrict、sizeof                             |
| **C11 新增**     | ***_Alignas、_Alignof、_Atomic、_Bool、_Complex、_Generic、_Imaginary、_Noreturn、_Static_assert、_Thread_local*** |

这些关键字就是我们命名标识符是必须避开的单词。

### 基本数据类型的类型转换

#### 自动类型转换

通常，在语句和表达式中应使用类型相同的变量和常量。但是，如果使用混合类型，C 不会像 Pascal 那样停在那里死掉，而是采用一套规则进行自动类型转换。虽然这很便利，但是有一定的危险性，尤其是在无意间混合使用类型的情况下（许多 UNIX 系统都使用 lint 程序检查类型“冲突”。如果选择更高错误级别，许多非 UNIX C编译器也可能报告类型问题）。最好先了解一些**基本的类型转换规则**：

1. 当类型转换出现在表达式时，无论是 unsigned 还是 signed 的 char 和 short 都会被自动转换成 int，如有必要会被转换成 unsigned int。在 K&R 时的 C 中，float 会被自动转换成 double（目前的 C 不是这样）。由于都是从较小类型转换为较大类型，所以这些转换被称为升级（promotion）

   > PS：char、short 转换为 unsigned int 的情况 —— 如果short与int的大小相同，unsigned short就比int大。这种情况下，unsigned short会被转换成 unsigned int。

2. 涉及两种类型的运算，两个值会被分别转换成两种类型的更高级别。

3. 类型的级别从高至低依次是 long double、double、float、unsigned long long、long long、unsigned long、long、unsigned int、int。例外的情况是，当 long 和 int 的大小相同时，unsigned int 比 long 的级别高。之所以 short 和 char 类型没有列出，是因为它们已经被升级到 int 或 unsigned int。

4. 在赋值表达式语句中，计算的最终结果会被转换成被赋值变量的类型。这个过程可能导致类型升级或降级（demotion）。所谓降级，是指把一种类型转换成更低级别的类型。

5. 当作为函数参数传递时，char 和 short 被转换成 int，float 被转换成 double。之后将介绍，函数原型会覆盖自动升级。

类型升级通常都不会有什么问题，但是类型降级会导致真正的麻烦。原因很简单：较低类型可能放不下整个数字。例如，一个 8 位的 char 类型变量储存整数 101 没问题，但是存不下 22334。



如果待转换的值与目标类型不匹配怎么办？这取决于转换涉及的类型。待赋值的值与目标类型不匹配时，规则如下：

1. 如果目标类型是无符号整型，且待赋的值是整数时，额外的位将被忽略。例如，如果目标类型是 8 位 unsigned char，待赋的值是原始值求模 256。 
2. 如果目标类型是一个有符号整型，且待赋的值是整数，结果因实现而异。
3. 如果目标类型是一个整型，且待赋的值是浮点数，该行为是未定义的。

如果把一个浮点值转换成整数类型会怎样？当浮点类型被降级为整数类型时，原来的浮点值会被截断。例如，23.12 和 23.99 都会被截断为 23，-23.5 会被截断为 -23。

#### 强制类型转换

通常，应该避免自动类型转换，尤其是类型降级。但是如果能小心使用，类型转换也很方便。我们前面讨论的类型转换都是自动完成的。然而，有时需要进行精确的类型转换，或者在程序中表明类型转换的意图。这种情况下要用到强制类型转换（cast），即在某个量的前面放置用圆括号括起来的类型名，该类型名即是希望转换成的目标类型。圆括号和它括起来的类型名构成了强制类型转换运算符（cast operator），其通用形式是：(type)，用实际类型替换 type 即可。

```c
int mice;
mice = 1.6 + 1.7;
mice = (int)1.6 + (int)1.7;
```

第 2 行使用自动类型转换。首先 1.6 + 1.7 得 3.3，然后为了匹配 int 类型变量，3.3 被类型转换截断为 3。

第 3 行使用强制类型转换。首先 1.6 和 1.7 被转换为 1，然后将值相加的结果 2 赋值给 mice。

本质上，两种类型转换都好不到哪里去，要考虑程序的具体情况再做取舍。

一般而言，不应该混合使用类型（因此有些语言直接不允许这样做），但是偶尔这样做也是有用的。C语言的原则是避免给程序员设置障碍，但是程序员必须承担使用的风险和责任